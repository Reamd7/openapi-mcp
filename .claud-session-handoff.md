# Claude 会话交接规范

> 此文件定义了 Claude 会话之间的交接协议,确保每个新会话能够快速接手任务。

---

## 会话启动清单

每个新 Claude 会话必须按以下顺序执行:

### 1. 读取指挥中心
```
📖 阅读 Claude.md
```

从 `Claude.md` 中获取:
- ✅ 当前项目阶段
- ✅ 当前任务状态
- ✅ 必读文档列表
- ✅ 下一步行动指引

### 2. 读取必读文档
```
📖 按 Claude.md 中的"当前阶段必读文档"列表阅读
```

### 3. 向用户确认
```
💬 "你好!我看到项目当前在 [阶段名], 状态是 [状态].
   我应该 [下一步行动] 吗?"
```

### 4. 开始工作
- 按 `PROGRESS.md` 执行任务
- 实时更新进度
- 完成后更新 `Claude.md`

---

## 会话结束清单

每个 Claude 会话结束前必须:

### 1. 更新进度文档
```
✅ 更新 PROGRESS.md 中的任务状态
```

### 2. 更新指挥中心
```
✅ 更新 Claude.md 的:
   - 当前状态速览
   - 当前任务
   - 下一步行动指引
   - 当前会话待办
```

### 3. 记录会话日志
```
✅ 在 PROGRESS.md 的"每日更新日志"中记录本次会话的工作
```

---

## 知识管理规则

### 信息流转图

```
新会话启动
    ↓
读取 Claude.md (获取当前状态)
    ↓
读取必读文档 (获取必要知识)
    ↓
执行任务
    ↓
更新 PROGRESS.md (记录详细进度)
    ↓
更新 Claude.md (更新状态)
    ↓
归档 (阶段完成时)
    ↓
会话结束
```

### 文档优先级

1. **最高优先级**: `Claude.md` - 唯一真相来源
2. **高优先级**: `PROGRESS.md` - 详细进度
3. **中优先级**: `WORKFLOW.md` - 方法论参考
4. **按需参考**: 当前阶段的技术文档
5. **归档文档**: 已完成阶段的产出

---

## 归档时机和方法

### 何时归档?

阶段完成并**通过用户评审**后立即归档。

### 如何归档?

1. 创建归档目录:
```bash
mkdir -p docs/archive/0X-阶段名/
```

2. 移动阶段产出文档:
```bash
# 示例: 阶段1完成后
mv PLAN.md docs/archive/01-requirements/
```

3. 更新 `Claude.md`:
   - 移除该阶段的详细内容
   - 添加归档路径引用
   - 精简为"产出摘要"

4. 更新 `PROGRESS.md`:
   - 标记阶段为"已归档"
   - 保留关键产出摘要

---

## 示例: 阶段转换流程

### 阶段 1 → 阶段 2 转换

#### 步骤 1: 用户批准
```
用户: "批准阶段1,开始阶段2"
```

#### 步骤 2: 更新 PROGRESS.md
```markdown
## ✅ 阶段 1: 需求分析 - 已完成并评审通过

**评审状态**: ✅ 通过
**评审时间**: 2024-12-19
**评审意见**: 需求明确,可以开始设计
```

#### 步骤 3: 归档阶段1文档
```bash
mkdir -p docs/archive/01-requirements/
mv PLAN.md docs/archive/01-requirements/
```

#### 步骤 4: 更新 Claude.md
```markdown
## 📍 当前状态速览
- **当前阶段**: **阶段 2: 系统设计** (进行中)

## 📚 当前阶段必读文档
### 核心文档 (必须阅读)
1. Claude.md
2. WORKFLOW.md
3. PROGRESS.md

### 参考文档 (归档)
- docs/archive/01-requirements/PLAN.md - 需求规划

## 🎯 当前任务
设计系统架构和模块接口
```

#### 步骤 5: 开始阶段2工作
创建 `src/types.ts`, `docs/DESIGN.md` 等

---

## 常见问题

### Q: 新会话如何知道从哪里开始?
A: 读取 `Claude.md` 的"当前任务"和"下一步行动指引"

### Q: 如何避免重复阅读已完成阶段的文档?
A: 归档机制。已完成阶段的详细文档移入 `docs/archive/`, `Claude.md` 只保留摘要

### Q: 如果需要回顾之前阶段的详细信息怎么办?
A: 查看 `docs/archive/0X-阶段名/` 中的归档文档

### Q: 多人协作如何保持同步?
A: 所有人都遵循"读 Claude.md → 做事 → 更新 Claude.md"的流程

---

## 模板: 新会话开场白

```
你好!我是 Claude,这是一个新的会话。

让我先检查项目状态...
[读取 Claude.md]

✅ 项目: MCP OpenAPI 查询服务器
✅ 当前阶段: [阶段名]
✅ 状态: [状态描述]

根据记录,我的下一步应该是:
[列出下一步行动]

我可以开始吗?还是有什么需要调整的?
```

---

**维护者**: 项目所有 Claude 会话
**最后更新**: 2024-12-19
